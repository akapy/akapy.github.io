<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

<link rel=stylesheet href="diary.css" media=all>

<link rel="alternate" type="application/rss+xml" title="RSS"
 href="rcl.rdf">
<title>rubyの勉強 / あかぴのChangeLog by rchalow</title>
</head>
<body>
<div class="main">
<a href="index.html">ChangeLog 最新ページ</a>

<h1>rubyの勉強 - <a href="index.html">あかぴのChangeLog by rchalow</a></h1>
<div class="body">

<!-- start:2012-08-04-1 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2012-08-04-1" href="2012-08-04-1.html"><span class="sanchor">■</span></a> <span class="clitemheader">after311.rb</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2012-08-04-1.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2012-08-04-1.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2012-08-04-1.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]</div>
  
  <div class="entry-content">
    <p><p>2011/3/11からの経過日数を数えるプログラム<br>
<blockquote>#!/usr/bin/env ruby<br>
$KCODE="EUC"<br>
</p><p>
require "date"<br>
d = Date.today<br>
d311 = Date.new(2011, 3 ,11)<br>
d_in = ARGV[0]<br>
d1 = Date.parse(d_in.to_s)<br>
</p><p>
print d311,"からの日数","\n"<br>
print "今日：", d ,"   ,", d - d311,"日後","\n"<br>
print "    ：",d1 ,"   ,", d1 - d311,"日後","\n"<br>
</blockquote>実行結果<br>
<blockquote>$ ./after311.rb 20110312<br>
2011-03-11からの日数<br>
今日：2012-08-04   ,512日後<br>
&nbsp;&nbsp;&nbsp;&nbsp;：2011-03-12   ,1日後<br>
</blockquote><hr>５１２日後<br>
</p><p>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- 広告とか -->



<!-- start:2010-02-11-1 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2010-02-11-1" href="2010-02-11-1.html"><span class="sanchor">■</span></a> <span class="clitemheader">tdiaryデータをChangeLog形式に変換</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2010-02-11-1.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2010-02-11-1.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2010-02-11-1.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]</div>
  
  <div class="entry-content">
    <p><p>td2からChangeLog形式に<br>
一部手動で手直しも必要だが、まあ実用の範囲。<br>
<blockquote>td2toclog+narabe.rb 200310.td2 > ~/tmp/200310<br>
&nbsp;&nbsp;<br>
entry-henkan.rb ~/tmp/200310 > ChangeLog.2003<br>
</blockquote>とりあえず、<br>
<a href="http://pub.cozmixng.org/~akapy/rchalow/2003-10.html">http://pub.cozmixng.org/~akapy/rchalow/2003-10.html</a><br>
</p><p>
</p><p>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!-- start:2009-02-16-3 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2009-02-16-3" href="2009-02-16-3.html"><span class="sanchor">■</span></a> <span class="clitemheader">td2toclog.rb</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2009-02-16-3.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2009-02-16-3.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2009-02-16-3.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]</div>
  
  <div class="entry-content">
    <p><p>tdiaryのdataの中のtd2ファイルをChangeLogに近い形に変換する。<br>
あとは日付でソートしたい、<br>
ディレクトリ内のtd2ファイルを順番に読み込んで処理したい。<br>
<blockquote>#!/usr/bin/env ruby<br>
$KCODE="EUC"<br>
#$/ = "\n"<br>
#$, = ","<br>
</p><p>
require "date"<br>
</p><p>
if ARGV[0] == nil<br>
&nbsp;&nbsp;STDERR.puts "引数が足りません"<br>
&nbsp;&nbsp;STDERR.puts "例：$ ./trunk/cl2sigoto-goukei.rb ~/trunk/ChangeLog"<br>
&nbsp;&nbsp;exit 0<br>
end<br>
</p><p>
entry = {}<br>
#p lioe<br>
goukei = 0<br>
</p><p>
while line = ARGF.gets<br>
</p><p>
###  print line<br>
&nbsp;&nbsp;if /^Title|^Last|^Visi|^Format|^\./ =~ line then<br>
#     p line<br>
&nbsp;&nbsp;elsif /^(Date: (\d{8}))/ =~ line then  # 日付をキープ<br>
&nbsp;&nbsp;&nbsp;&nbsp;d = $2		# = year-month-day<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date = Date.parse(d)<br>
#            puts date<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print date," akapy  &lt;akapy@coz>"<br>
#            p d2<br>
</p><p>
&nbsp;&nbsp;else<br>
</p><p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print line<br>
&nbsp;&nbsp;end<br>
end<br>
<<<br>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!-- start:2007-11-19-1 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2007-11-19-1" href="2007-11-19-1.html"><span class="sanchor">■</span></a> <span class="clitemheader">cels2fahr</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_e4bfaee8a18c.html">修行</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2007-11-19-1.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2007-11-19-1.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2007-11-19-1.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_e4bfaee8a18c.html">修行</a>]</div>
  
  <div class="entry-content">
    <p><p>一番簡単に<br>
cels2fahr-1.rb<br>
<blockquote>def cels2fahr(cels)<br>
&nbsp;&nbsp;fahr = cels * 9 / 5 + 32<br>
#  print("Kashi:",fahr,"\n")<br>
&nbsp;&nbsp;print("Sesshi:",cels,"\t","Kashi:",fahr,"\n")<br>
end<br>
</p><p>
cels2fahr(3.0)<br>
</blockquote>コマンドラインからデータを入力すると<br>
cels2fahr-2.rb<br>
<blockquote>def cels2fahr(cels)<br>
&nbsp;&nbsp;fahr = cels * 9 / 5 + 32<br>
&nbsp;&nbsp;print("Sesshi:",cels,"\t","Kashi:",fahr,"\n")<br>
end<br>
</p><p>
cels = ARGV[0]<br>
p cels<br>
cels2fahr(cels.to_f)<br>
</blockquote>解答は<a href="http://www.notwork.org/sbcr-ruby/answer/">http://www.notwork.org/sbcr-ruby/answer/</a>にあるらしい。<br>
４問全部終わったら見てみるか。<br>
どの程度合っていることやら。<br>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!-- start:2006-07-19-1 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2006-07-19-1" href="2006-07-19-1.html"><span class="sanchor">■</span></a> <span class="clitemheader">今日のruby</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_chalow-rb.html">chalow-rb</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2006-07-19-1.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2006-07-19-1.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2006-07-19-1.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_chalow-rb.html">chalow-rb</a>]</div>
  
  <div class="entry-content">
    <p><p><blockquote><pre>#!/usr/local/bin/ruby
$KCODE=&quot;EUC&quot;
# $pat = /#{ARGV.shift}/
while line = ARGF.gets
#   if $_ =~ $pat
#      # マッチした部分の前後にエスケープシーケンスを埋め込む
#      line.gsub! $pat, &quot;#{st}\\&amp;#{en}&quot;
#      line.gsub(/#/,&quot;＃&quot;)
#      print &quot;\t\t\t\t###&quot;,line                               # (TAB)(TAB)(TAB)###各行
#      print &quot;  &quot;,line.sub(/(?:\r|\r\n|\n)\z/, &quot;&quot;),&quot;, ,\r\n&quot;   # __(改行文字削除した行),_,改行
#      print line.gsub(/#/,&quot;＃&quot;)
#      print line.gsub(/,/,&quot;[かんま]&quot;)
      print line.gsub(/\t/,&quot;        &quot;)                       # TABを空白８文字に変換
#   end
end</pre>
<<<br>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!-- start:2006-02-15-3 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2006-02-15-3" href="2006-02-15-3.html"><span class="sanchor">■</span></a> <span class="clitemheader">cl2kaimono-itiran-csv.rb</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_chalow.html">chalow</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2006-02-15-3.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2006-02-15-3.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2006-02-15-3.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_chalow.html">chalow</a>]</div>
  
  <div class="entry-content">
    <p><p>cl2moneycsv.plを改造して[買物ログ]部分だけをcsv化できた。<br>
これで確定申告に間に合いそうだ。<br>
<blockquote>svn add cl2kaimono-itiran-csv.rb  しておいた(笑)<br>
</blockquote>最後は表計算ソフトが必要なんだけどOpenOffice.orgは重過ぎるしな。印刷もしたいし。<br>
Winの１２３かな。<br>
<strong>Linuxな表計算ソフトと、印刷は今後の課題としよう。</strong><br>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!-- start:2006-01-19-2 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2006-01-19-2" href="2006-01-19-2.html"><span class="sanchor">■</span></a> <span class="clitemheader">cl2kaimonocsv.rb</span> [<a href="cat_e4bfaee8a18c.html">修行</a>][<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_chalow.html">chalow</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2006-01-19-2.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2006-01-19-2.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2006-01-19-2.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_e4bfaee8a18c.html">修行</a>][<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>][<a href="cat_chalow.html">chalow</a>]</div>
  
  <div class="entry-content">
    <p><p><blockquote>[src]<br>
#!/usr/bin/env ruby<br>
$KCODE="EUC"<br>
#<br>
##!/usr/bin/env perl<br>
# $Id: ChangeLog 1250 2007-06-05 14:58:37Z akapy $<br>
# ChangeLog メモで家計簿!<br>
#  ref. &lt;<a href="http://nais.to/~yto/doc/zb/0016.html#kakeibo">http://nais.to/~yto/doc/zb/0016.html#kakeibo</a>><br>
#<br>
# ■フォーマット<br>
#買a物ログ:<br>
# ^\t[費目][スペース][コメント][金額]$<br>
# - スペースは半角でも全角でも良い。<br>
# - 金額は半角数字。桁カンマは入れてはいけない。<br>
#<br>
# ■注意<br>
# - 日本語コードは EUC を仮定<br>
# - Excel に読み込ませる前に文字コードを Shift-JIS に変換する必要あり<br>
#<br>
# ■記述例＆実行例<br>
# <br>
# $ cat ChangeLog<br>
# 2003-08-02  YAMASHITA Tatsuo  &lt;yto@example.com><br>
# <br>
# 	* できごと: だらだらしてた。<br>
# <br>
# 	* p:買a物ログ: <br>
# 	食 スーパー 1050<br>
# 	本 コンビニで雑誌 380<br>
# <br>
# 2003-08-01  YAMASHITA Tatsuo  &lt;yto@example.com><br>
# <br>
# 	* できごと: 川崎で映画。<br>
# <br>
# 	* p:買a物ログ: <br>
# 	外 ファーストフード 525<br>
# 	遊 映画 2000<br>
# 	交 川崎往復 420<br>
# 	食 スーパー 780<br>
# <br>
# 2003-07-31  YAMASHITA Tatsuo  &lt;yto@example.com><br>
# <br>
# 	* できごと: 渋谷に出掛けた。<br>
# <br>
# 	* p:買a物ログ: <br>
# 	外 レストラン 3000<br>
# 	交 渋谷往復 640<br>
# 	雑 ペンとメモ帳 550<br>
# <br>
# $ cl2moneycsv.pl ChangeLog<br>
#           ,  外,  食,  交,  遊,  本,  音,  雑,  衣,  他<br>
# 2003.07.31,3000,   0, 640,   0,   0,   0, 550,   0,   0<br>
# 2003.08.01, 525, 780, 420,2000,   0,   0,   0,   0,   0<br>
# 2003.08.02,   0,1050,   0,   0, 380,   0,   0,   0,   0<br>
# $ cl2moneycsv.pl -m ChangeLog  (←月毎に集計)<br>
#           ,  外,  食,  交,  遊,  本,  音,  雑,  衣,  他<br>
# 2003-07,3000,   0, 640,   0,   0,   0, 550,   0,   0<br>
# 2003-08, 525,1830, 420,2000, 380,   0,   0,   0,   0<br>
# $ cl2moneycsv.pl -m ChangeLog | nkf -s > kaimono.csv<br>
</p><p>
# use strict;<br>
</p><p>
</p><p>
# 費目 an item of expendidure<br>
#my @lioe = ('外', '食', '交', '遊', '本', '音', '雑', '衣', '他')<br>
lioe = ["外","食","交","遊","本","音","雑","衣","他"]<br>
#lioe = %w(外 食 交 )<br>
</p><p>
inside_flag = 0<br>
</p><p>
entry = {}<br>
p lioe<br>
</p><p>
</p><p>
#while (<>) {<br>
#while <><br>
while line = ARGF.gets<br>
&nbsp;&nbsp;&nbsp;&nbsp;if /^((\d{4}-\d\d)-\d\d)/ =~ line then  # 日付をキープ<br>
&nbsp;&nbsp;&nbsp;&nbsp;date = $1		# = year-month-day<br>
#	    $date =~ s|-|.|g	# for Excel<br>
#            p date<br>
&nbsp;&nbsp;&nbsp;&nbsp;elsif /買a物ログ:/ =~ line then	# 家計簿データ記述ブロックの始まり<br>
inside_flag = 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;elsif inside_flag == 1 then   # ブロック内<br>
if /^\s*$/ =~ line and inside_flag == 1 then  # ブロックの終わり<br>
&nbsp;&nbsp;&nbsp;&nbsp;inside_flag = 0<br>
else	#  /^\t(.+?)(\s|\xa1\xa1).*(\s|\xa1\xa1)(\d+)$/<br>
&nbsp;&nbsp;kamoku = $1<br>
&nbsp;&nbsp;naiyou = $2<br>
&nbsp;&nbsp;kingaku = $3<br>
&nbsp;&nbsp;p date,line.chomp.split(nil)<br>
#	  p date,kamoku,naiyou,kingaku<br>
&nbsp;&nbsp;# $1,$2,$3,$4,$5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br>
&nbsp;&nbsp;&nbsp;&nbsp;end<br>
end<br>
</p><p>
=begin<br>
85,89,92<br>
#print " " x 10, ",  ", join(',  ', @lioe), "\n"<br>
p " " x 10, ",  ", join(',  ', lioe), "\n"<br>
</p><p>
#foreach date (sort keys entry) {<br>
#    print "$date,"<br>
#    print join(',', map {sprintf "%4d", $entry{$date}{$_}} @lioe), "\n"<br>
#}<br>
date.times<br>
&nbsp;&nbsp;&nbsp;p date ;<br>
end<br>
</p><p>
=end<br>
[src]<br>
<<<br>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!-- start:2005-11-03-1 -->
<div class="section hentry">
  <div class="entry-title">
    <h3 class="subtitle"><a id="2005-11-03-1" href="2005-11-03-1.html"><span class="sanchor">■</span></a> <span class="clitemheader">euc変換</span> [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]
      <a href="https://b.hatena.ne.jp/entry/https://akapy.github.io/rchalow/2005-11-03-1.html">
        <img src="https://b.hatena.ne.jp/entry/image/https://akapy.github.io/rchalow/2005-11-03-1.html" class="no_border" alt="はてぶ">
      </a>
      <span class="hatesta"><a href="2005-11-03-1.html"></a></span>
    </h3>
  </div>
  
  <div class="entry-tag">tag: [<a href="cat_rubye381aee58b89e5bcb7.html">rubyの勉強</a>]</div>
  
  <div class="entry-content">
    <p><p>work/euc_changelog.sh<br>
<blockquote><pre>#!/bin/bash
./to_euc_changelog.rb ~/trunk/ChangeLog
&lt;&lt;
work/to_euc_changelog.rb
&gt;&gt;
#!/usr/local/bin/ruby -i.bak
require &quot;kconv&quot;
while line = ARGF.gets
   print Kconv.toeuc(line)
end</pre>
<<<br>
      
    </p>
    
  </div>
</div>
<!-- end:<TMPL_VAR name=ymdi> -->
<!-- ReplaceOnce -->


<!---->
</div>
<div>
最終更新時間: 2025-01-19 09:47

</div></div></body></html>
