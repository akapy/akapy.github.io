<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

 <link rel=stylesheet href="diary.css" media=all>

<link rel="alternate" type="application/rss+xml" title="RSS"
 href="rcl.rdf">
<title>cl2moneycsv-kamoku.rb</title>
</head>
<body>

<a href="2006-10-24-7.html">Prev</a>


 / <a href="2006-10-25-2.html">Next</a>

/ <a href="index.html">あかぴのChangeLog by rchalow</a>
<h1>cl2moneycsv-kamoku.rb[ひとりごと]<br><TMPL_VAR name=cat></h1>
<div class="day">
<a href="2006-10-25.html">2006-10-25</a>
<div class="body">
<!-- start:2006-10-25-1 -->
<div class="section">
<h3 class="subtitle"><a name="2006-10-25-1" href="2006-10-25-1.html"><span class="sanchor">＊</span></a> <span class="clitemheader">cl2moneycsv-kamoku.rb</span> [<a href="cat_e381b2e381a8e3828ae38194e381a8.html">ひとりごと</a>]</h3>
<p><blockquote><pre>#!/usr/bin/env ruby
$KCODE="EUC"
#$/ = "\n"
#$, = ","
#

if ARGV[0] == nil
  STDERR.puts "引数が足りません"
  STDERR.puts "例：./rubyprog/cl2moneycsv-kamoku.rb ~/trunk/ChangeLog"
  exit 0
end

# 費目 an item of expendidure
#my @lioe = ('外', '食', '交', '遊', '本', '音', '雑', '衣', '他')
lioe = ["外","食","交","遊","本","音","雑","衣","他"]
#lioe = %w(外 食 交 )

inside_flag = 0
kamo = []
k = 0

entry = {}
p lioe


#while line = ARGF.gets
while line = gets
#  print line
    if /^((\d{4}-\d\d)-\d\d)/ =~ line then  # 日付をキープ
#     if /^((\d{4}-\d\d)-\d\d)/ and /^((2005-\d\d)-\d\d)/ =~ line then  # 日付をキープ
    date = $1		# = year-month-day
#	    $date =~ s|-|.|g	# for Excel
#            p date
    elsif /買#物ログ.*:/ =~ line then	# 家計簿データ記述ブロックの始まり
inside_flag = 1
tag = $&amp;
    elsif inside_flag == 1 then   # ブロック内
if /^\s*$/ =~ line and inside_flag == 1 then  # ブロックの終わり
    inside_flag = 0
else
  /^\t(.+?)(\s|\xa1\xa1).*(\s|\xa1\xa1)(\d+)$/ =~ line
yo = line.split(nil)
#	  kamoku = $1
#	  naiyou = $2
#	  kingaku = $3
  kamoku = yo[0]
  naiyou = yo[1]
  kingaku = yo[2]
  sonota = yo[3]

          kamo.push(yo[0])
          kamo.uniq!
          p kamo

#	  p date,tag,line.chomp.split(nil)
#	  if /2005-\d\d-\d\d/ =~ date then 
#	    print date,",",tag,",",kamoku,",",naiyou,",",kingaku,"\n"
#	  end
       end
    end
end</pre>
</blockquote><br>

</p>

<div class="comment">
<div class="caption">［
<a href="2006-10-25-1.html">固定リンク</a> ｜
<a href="2006-10-25-1.html#disqus_thread">Comments (View)</a>
］</div>

</div>

<!--200610251-->
</div>
<!-- end:2006-10-25-1 -->
<!-- 広告とか -->



<div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/akapy/embed.js"></script><noscript><a href="http://akapy.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

</div></div>
<!--<p>last update: 2012-07-04 06:43</p>-->

</div>

<!-- Disqus -->
<script type="text/javascript">
//<![CDATA[
(function() {
		var links = document.getElementsByTagName('a');
		var query = '?';
		for(var i = 0; i < links.length; i++) {
			if(links[i].href.indexOf('#disqus_thread') >= 0) {
				query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
			}
		}
		document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/akapy/get_num_replies.js' + query + '"></' + 'script>');
	})();
//]]>
</script>
<!-- /Disqus -->
</body></html>
